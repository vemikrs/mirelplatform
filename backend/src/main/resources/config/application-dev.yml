# application-dev.yml - Development Environment Configuration
# PostgreSQL (docker-compose.dev.yml) を使用
spring:
  datasource:
    url: jdbc:postgresql://localhost:5432/mirelplatform
    driver-class-name: org.postgresql.Driver
    username: mirel
    password: mirel
  session:
    jdbc:
      schema: classpath:org/springframework/session/jdbc/schema-postgresql.sql
  jpa:
    database-platform: org.hibernate.dialect.PostgreSQLDialect
    hibernate:
      ddl-auto: update
    properties:
      hibernate:
        jdbc:
          lob:
            non_contextual_creation: true
    show-sql: true
  # Spring Boot Mail設定（JavaMailSender Bean生成用）
  mail:
    host: localhost
    port: 1025
    properties:
      mail:
        smtp:
          auth: false
          starttls:
            enable: false
  # 開発環境用OAuth2設定（ダミー値で設定エラー回避）
  security:
    oauth2:
      client:
        registration:
          github:
            client-id: dummy-dev-client-id
            client-secret: dummy-dev-client-secret

logging:
  level:
    jp.vemi.mirel: DEBUG
    jp.vemi.framework: DEBUG
    jp.vemi.ste: DEBUG
    org.springframework.security: DEBUG

mirel:
  storage-dir: ./data/storage
  stencil:
    layers:
      user: ${mirel.storage-dir}/apps/promarker/stencil/user
      standard: ${mirel.storage-dir}/apps/promarker/stencil/standard
      samples: classpath:/promarker/stencil/samples
    auto-deploy-samples: true

# Development-only: Security configuration for SaaS authentication testing
# CSRF is disabled for development convenience
# In production, set enabled=true and csrf-enabled=true
mipla2:
  security:
    api:
      enabled: true  # SaaS認証テスト用に有効化
      csrf-enabled: false  # 開発時はCSRF無効（本番では true）

# JWT authentication method (default in WebSecurityConfig)
auth:
  method: jwt  # JWT認証を利用
  jwt:
    enabled: true  # JWT有効化

# JWT秘密鍵(開発用固定値)
jwt:
  secret: dGVzdC1zZWNyZXQta2V5LWZvci1kZXZlbG9wbWVudC1vbmx5LTEyMzQ1Njc4OTBhYmNkZWY=

# 開発環境用OTP設定 (有効期限を長めに、E2Eテスト考慮)
otp:
  expiration-minutes: 10
  resend-cooldown-seconds: 10  # 再送信クールダウン(秒)

# 開発環境用レート制限 (緩和 - E2Eテスト考慮)
rate-limit:
  otp:
    request-per-minute: 6  # 60秒間に6回までリクエスト可能
    verify-per-minute: 20

# 開発環境用メール設定 (MailHog)
# 注: spring.mail は JavaMailSender Bean 生成用
# email.provider は アプリケーション層のメール送信先制御用
email:
  provider: smtp
  smtp:
    host: localhost
    port: 1025
