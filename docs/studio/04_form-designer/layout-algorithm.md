# mirel Studio Form Designer レイアウトアルゴリズム

> 12 グリッドレイアウトを基盤とした自動配置と手動調整

---

## 1. 基本のグリッド構造

mirel Studio Form Designer は「12 グリッドレイアウト」を基盤とし、自動配置と手動調整を組み合わせた構造を取る。

```
1 行 = 12 カラム
カラム幅は 1〜12 の整数
```

**例：**
- 6 → 画面幅の 50%
- 12 → フル幅

---

## 2. 自動レイアウトアルゴリズム

Modeler のフィールドをフォームに配置する際、以下のルールで初期配置される。

| フィールドタイプ | カラム幅 |
|----------------|---------|
| primitive type | 6 |
| 複合（Embedded） | 12 |
| textarea/html | 12 |
| date/time | 4 |
| boolean | 3 |

並び順は Modeler のフィールド順に従う。

---

## 3. 行の自動折返し

フィールド合計が 12 を超える場合、自動で改行。

**例：**

```
6 + 6 → OK（1 行）
6 + 8 → 折返し（2 行目に 8）
```

---

## 4. 手動レイアウト調整

ユーザーは以下を手動で変更可能：

| 項目 | 説明 |
|------|------|
| カラム幅 | 1〜12 の範囲で設定 |
| 行位置 | ドラッグ＆ドロップで移動 |
| セクション分割 | 論理的なグループ化 |
| タブ配置 | タブ構造への変換 |
| 折りたたみ構造 | Accordion への変換 |

---

## 5. レイアウト衝突の検出

以下の状況は検出して警告を出す：

| 状況 | 警告内容 |
|------|---------|
| カラム数 > 12 | 「行のカラム数が 12 を超えています」 |
| 空白行の大量生成 | 「不要な空白行があります」 |
| 無意味に広すぎるコンポーネント | 「レイアウトの最適化を推奨」 |

---

## 6. レスポンシブ対応

将来拡張として以下を提供予定：

- モバイル端末時の自動縦配置
- カラム幅のレスポンシブ設定（lg/md/sm）

---

## 7. 設計意図

- Builder による初期配置の手間を削減
- モデル中心に UI を設計
- 過度な装飾を避け、生産性を重視

---

## 関連ドキュメント

- [Widget 仕様](./widget-spec.md)
- [Modeler 連携](./modeler-sync.md)
- [UX 原則](../01_concept/ux-principles.md)

---

*Powered by Copilot 🤖*
