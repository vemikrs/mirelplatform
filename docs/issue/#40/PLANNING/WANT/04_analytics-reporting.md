# é«˜åº¦ãªåˆ†æãƒ»ãƒ¬ãƒãƒ¼ãƒ†ã‚£ãƒ³ã‚°æ©Ÿèƒ½ è¨­è¨ˆæ›¸

## ğŸ“‹ æ¦‚è¦

ã‚µãƒ¼ãƒ“ã‚¹é‹å–¶è€…ãŠã‚ˆã³é¡§å®¢å‘ã‘ã®åˆ†æãƒ»å¯è¦–åŒ–æ©Ÿèƒ½ç¾¤ã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       Analytics & Reporting Architecture                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                     â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚   â”‚                         Data Collection Layer                                â”‚ â”‚
â”‚   â”‚                                                                              â”‚ â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚
â”‚   â”‚  â”‚  Application â”‚  â”‚   Billing    â”‚  â”‚   Usage      â”‚  â”‚   User       â”‚   â”‚ â”‚
â”‚   â”‚  â”‚   Events     â”‚  â”‚    Data      â”‚  â”‚   Metrics    â”‚  â”‚  Behavior    â”‚   â”‚ â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚
â”‚   â”‚         â”‚                  â”‚                  â”‚                  â”‚         â”‚ â”‚
â”‚   â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚ â”‚
â”‚   â”‚                            â–¼                  â–¼                             â”‚ â”‚
â”‚   â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚ â”‚
â”‚   â”‚                    â”‚     Event Stream / Queue        â”‚                     â”‚ â”‚
â”‚   â”‚                    â”‚     (Kafka / Redis Streams)     â”‚                     â”‚ â”‚
â”‚   â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚ â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                            â”‚                                       â”‚
â”‚                                            â–¼                                       â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚   â”‚                         Processing & Storage Layer                           â”‚ â”‚
â”‚   â”‚                                                                              â”‚ â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚
â”‚   â”‚  â”‚                        Data Warehouse                                 â”‚  â”‚ â”‚
â”‚   â”‚  â”‚                                                                       â”‚  â”‚ â”‚
â”‚   â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚ â”‚
â”‚   â”‚  â”‚  â”‚   Events    â”‚  â”‚   Metrics   â”‚  â”‚  Aggregates â”‚  â”‚   Reports   â”‚ â”‚  â”‚ â”‚
â”‚   â”‚  â”‚  â”‚   (Raw)     â”‚  â”‚   (Daily)   â”‚  â”‚  (Weekly/   â”‚  â”‚  (Cached)   â”‚ â”‚  â”‚ â”‚
â”‚   â”‚  â”‚  â”‚             â”‚  â”‚             â”‚  â”‚   Monthly)  â”‚  â”‚             â”‚ â”‚  â”‚ â”‚
â”‚   â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚ â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                            â”‚                                       â”‚
â”‚                                            â–¼                                       â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚   â”‚                         Presentation Layer                                   â”‚ â”‚
â”‚   â”‚                                                                              â”‚ â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚
â”‚   â”‚  â”‚   Admin      â”‚  â”‚   Tenant     â”‚  â”‚   Custom     â”‚  â”‚    Export    â”‚   â”‚ â”‚
â”‚   â”‚  â”‚  Dashboard   â”‚  â”‚  Analytics   â”‚  â”‚  Dashboards  â”‚  â”‚    (CSV/PDF) â”‚   â”‚ â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 1ï¸âƒ£ åˆ©ç”¨çŠ¶æ³ã‚¢ãƒŠãƒªãƒ†ã‚£ã‚¯ã‚¹

### 1.1 ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°å¯¾è±¡

| ã‚«ãƒ†ã‚´ãƒª | ãƒ¡ãƒˆãƒªã‚¯ã‚¹ | ç”¨é€” |
|----------|------------|------|
| ãƒ­ã‚°ã‚¤ãƒ³ | DAU, WAU, MAU | ã‚¨ãƒ³ã‚²ãƒ¼ã‚¸ãƒ¡ãƒ³ãƒˆè¨ˆæ¸¬ |
| æ©Ÿèƒ½åˆ©ç”¨ | æ©Ÿèƒ½åˆ¥åˆ©ç”¨å›æ•°ãƒ»æ™‚é–“ | æ©Ÿèƒ½æ¡ç”¨ç‡åˆ†æ |
| APIå‘¼ã³å‡ºã— | ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆåˆ¥çµ±è¨ˆ | å®¹é‡ãƒ—ãƒ©ãƒ³ãƒ‹ãƒ³ã‚° |
| ã‚¨ãƒ©ãƒ¼ | ã‚¨ãƒ©ãƒ¼ç‡ãƒ»ç¨®åˆ¥ | å“è³ªæ”¹å–„ |
| ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ | ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚¿ã‚¤ãƒ  | UXæ”¹å–„ |

### 1.2 ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«

```java
@Entity
@Table(name = "usage_events")
public class UsageEvent {
    @Id
    @GeneratedValue(strategy = GenerationType.UUID)
    private String id;

    @Column(nullable = false)
    private String tenantId;

    private String userId;

    @Column(nullable = false)
    private String eventType; // page_view, feature_use, api_call, etc.

    @Column(nullable = false)
    private String eventName; // dashboard.view, report.generate, etc.

    @Column(columnDefinition = "jsonb")
    private String properties; // è¿½åŠ ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£

    private String sessionId;
    private String deviceType;
    private String userAgent;

    @Column(nullable = false)
    private LocalDateTime eventTime;

    private LocalDateTime createdAt;
}

@Entity
@Table(name = "daily_usage_metrics")
public class DailyUsageMetric {
    @Id
    @GeneratedValue(strategy = GenerationType.UUID)
    private String id;

    @Column(nullable = false)
    private String tenantId;

    @Column(nullable = false)
    private LocalDate date;

    private int activeUsers;
    private int newUsers;
    private int sessions;
    private int pageViews;
    private int apiCalls;

    @Column(columnDefinition = "jsonb")
    private String featureUsage; // { "feature1": 100, "feature2": 50 }

    @Column(columnDefinition = "jsonb")
    private String topPages; // [{ "page": "/dashboard", "views": 500 }]

    private LocalDateTime calculatedAt;
}
```

### 1.3 é›†è¨ˆã‚¸ãƒ§ãƒ–

```java
@Service
public class UsageAggregationService {

    @Scheduled(cron = "0 0 1 * * *") // æ¯æ—¥1:00
    public void aggregateDailyUsage() {
        LocalDate yesterday = LocalDate.now().minusDays(1);
        
        List<String> tenantIds = tenantRepository.findAllActiveIds();
        
        for (String tenantId : tenantIds) {
            DailyUsageMetric metric = calculateDailyMetric(tenantId, yesterday);
            dailyUsageMetricRepository.save(metric);
        }
    }

    private DailyUsageMetric calculateDailyMetric(String tenantId, LocalDate date) {
        LocalDateTime startOfDay = date.atStartOfDay();
        LocalDateTime endOfDay = date.plusDays(1).atStartOfDay();

        return DailyUsageMetric.builder()
            .tenantId(tenantId)
            .date(date)
            .activeUsers(usageEventRepository.countDistinctUsers(tenantId, startOfDay, endOfDay))
            .sessions(usageEventRepository.countDistinctSessions(tenantId, startOfDay, endOfDay))
            .pageViews(usageEventRepository.countByEventType(tenantId, "page_view", startOfDay, endOfDay))
            .apiCalls(usageEventRepository.countByEventType(tenantId, "api_call", startOfDay, endOfDay))
            .featureUsage(calculateFeatureUsage(tenantId, startOfDay, endOfDay))
            .calculatedAt(LocalDateTime.now())
            .build();
    }
}
```

---

## 2ï¸âƒ£ ãƒ“ã‚¸ãƒã‚¹ã‚¤ãƒ³ãƒ†ãƒªã‚¸ã‚§ãƒ³ã‚¹

### 2.1 åç›Šåˆ†æãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Revenue Analytics Dashboard                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Key Metrics                                                         â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚  â”‚
â”‚  â”‚  â”‚   MRR    â”‚  â”‚   ARR    â”‚  â”‚  Churn   â”‚  â”‚   LTV    â”‚             â”‚  â”‚
â”‚  â”‚  â”‚ Â¥2.5M   â”‚  â”‚ Â¥30M    â”‚  â”‚  2.5%   â”‚  â”‚ Â¥150K   â”‚             â”‚  â”‚
â”‚  â”‚  â”‚ â–² 8%    â”‚  â”‚ â–² 15%   â”‚  â”‚ â–¼ 0.3%  â”‚  â”‚ â–² 12%   â”‚             â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  MRR Growth                      â”‚  Revenue by Plan                 â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚
â”‚  â”‚  â”‚                    â–„â–„â–„â–„   â”‚  â”‚  â”‚  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ Pro 45%         â”‚ â”‚  â”‚
â”‚  â”‚  â”‚                â–„â–„â–„â–„â–ˆâ–ˆâ–ˆâ–ˆ   â”‚  â”‚  â”‚  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ Standard 30%      â”‚ â”‚  â”‚
â”‚  â”‚  â”‚            â–„â–„â–„â–„â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   â”‚  â”‚  â”‚  â–ˆâ–ˆâ–ˆâ–ˆ Enterprise 20%      â”‚ â”‚  â”‚
â”‚  â”‚  â”‚        â–„â–„â–„â–„â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   â”‚  â”‚  â”‚  â–ˆâ–ˆ Free Trial 5%         â”‚ â”‚  â”‚
â”‚  â”‚  â”‚    â–„â–„â–„â–„â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚
â”‚  â”‚  â”‚ â–„â–„â–„â–„â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  â”‚  â”‚                                  â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚                                  â”‚  â”‚
â”‚  â”‚   Jan Feb Mar Apr May Jun       â”‚                                  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Cohort Analysis                                                     â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚  â”‚
â”‚  â”‚  â”‚      M0    M1    M2    M3    M4    M5    M6                 â”‚    â”‚  â”‚
â”‚  â”‚  â”‚  Jan  100%  85%   78%   72%   68%   65%   63%              â”‚    â”‚  â”‚
â”‚  â”‚  â”‚  Feb  100%  88%   80%   75%   70%   67%                    â”‚    â”‚  â”‚
â”‚  â”‚  â”‚  Mar  100%  90%   82%   77%   73%                          â”‚    â”‚  â”‚
â”‚  â”‚  â”‚  Apr  100%  87%   79%   74%                                â”‚    â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 ä¸»è¦KPIè¨ˆç®—

```java
@Service
public class RevenueAnalyticsService {

    // MRR (Monthly Recurring Revenue)
    public BigDecimal calculateMRR(LocalDate date) {
        return subscriptionRepository.findActiveAsOf(date).stream()
            .map(Subscription::getMonthlyAmount)
            .reduce(BigDecimal.ZERO, BigDecimal::add);
    }

    // ARR (Annual Recurring Revenue)
    public BigDecimal calculateARR(LocalDate date) {
        return calculateMRR(date).multiply(BigDecimal.valueOf(12));
    }

    // Churn Rate
    public BigDecimal calculateChurnRate(YearMonth month) {
        LocalDate startOfMonth = month.atDay(1);
        LocalDate endOfMonth = month.atEndOfMonth();
        
        long customersAtStart = subscriptionRepository.countActiveAsOf(startOfMonth);
        long churnedDuringMonth = subscriptionRepository.countChurnedBetween(startOfMonth, endOfMonth);
        
        if (customersAtStart == 0) return BigDecimal.ZERO;
        
        return BigDecimal.valueOf(churnedDuringMonth)
            .divide(BigDecimal.valueOf(customersAtStart), 4, RoundingMode.HALF_UP)
            .multiply(BigDecimal.valueOf(100));
    }

    // LTV (Lifetime Value)
    public BigDecimal calculateAverageLTV() {
        BigDecimal avgMonthlyRevenue = subscriptionRepository.calculateAverageMonthlyRevenue();
        BigDecimal avgLifetimeMonths = subscriptionRepository.calculateAverageLifetimeMonths();
        
        return avgMonthlyRevenue.multiply(avgLifetimeMonths);
    }

    // Cohort Retention
    public Map<YearMonth, Map<Integer, BigDecimal>> calculateCohortRetention(
        YearMonth startMonth, int monthsToAnalyze
    ) {
        Map<YearMonth, Map<Integer, BigDecimal>> result = new LinkedHashMap<>();
        
        for (int i = 0; i < monthsToAnalyze; i++) {
            YearMonth cohortMonth = startMonth.minusMonths(i);
            List<String> cohortCustomers = subscriptionRepository.findCustomersStartedIn(cohortMonth);
            
            Map<Integer, BigDecimal> retention = new LinkedHashMap<>();
            for (int month = 0; month <= i; month++) {
                YearMonth checkMonth = cohortMonth.plusMonths(month);
                long retained = subscriptionRepository.countActiveInMonthFromCohort(
                    cohortCustomers, checkMonth
                );
                BigDecimal rate = BigDecimal.valueOf(retained)
                    .divide(BigDecimal.valueOf(cohortCustomers.size()), 4, RoundingMode.HALF_UP)
                    .multiply(BigDecimal.valueOf(100));
                retention.put(month, rate);
            }
            
            result.put(cohortMonth, retention);
        }
        
        return result;
    }
}
```

---

## 3ï¸âƒ£ äºˆæ¸¬åˆ†æï¼ˆAI/MLï¼‰

### 3.1 è§£ç´„äºˆæ¸¬ãƒ¢ãƒ‡ãƒ«

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Churn Prediction Pipeline                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Feature Engineering                                                 â”‚  â”‚
â”‚  â”‚                                                                       â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚  â”‚
â”‚  â”‚  â”‚  Usage Metrics â”‚  â”‚  Billing Data  â”‚  â”‚  Support Data  â”‚         â”‚  â”‚
â”‚  â”‚  â”‚  ãƒ»DAU trend   â”‚  â”‚  ãƒ»Payment histâ”‚  â”‚  ãƒ»Ticket countâ”‚         â”‚  â”‚
â”‚  â”‚  â”‚  ãƒ»Feature use â”‚  â”‚  ãƒ»Plan changesâ”‚  â”‚  ãƒ»Sentiment   â”‚         â”‚  â”‚
â”‚  â”‚  â”‚  ãƒ»API calls   â”‚  â”‚  ãƒ»Failed pay  â”‚  â”‚                â”‚         â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚  â”‚
â”‚  â”‚           â”‚                  â”‚                  â”‚                    â”‚  â”‚
â”‚  â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚  â”‚
â”‚  â”‚                              â–¼                                       â”‚  â”‚
â”‚  â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                            â”‚  â”‚
â”‚  â”‚                    â”‚  Feature Vector    â”‚                            â”‚  â”‚
â”‚  â”‚                    â”‚  [f1, f2, ..., fn] â”‚                            â”‚  â”‚
â”‚  â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                            â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                    â”‚                                       â”‚
â”‚                                    â–¼                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  ML Model (Scikit-learn / TensorFlow)                               â”‚  â”‚
â”‚  â”‚                                                                       â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”‚
â”‚  â”‚  â”‚                                                               â”‚   â”‚  â”‚
â”‚  â”‚  â”‚   Gradient Boosting / Random Forest / Neural Network         â”‚   â”‚  â”‚
â”‚  â”‚  â”‚                                                               â”‚   â”‚  â”‚
â”‚  â”‚  â”‚   Output: Churn Probability (0.0 - 1.0)                      â”‚   â”‚  â”‚
â”‚  â”‚  â”‚                                                               â”‚   â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                    â”‚                                       â”‚
â”‚                                    â–¼                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Risk Segmentation                                                   â”‚  â”‚
â”‚  â”‚                                                                       â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚  â”‚
â”‚  â”‚  â”‚  ğŸ”´ High   â”‚    â”‚  ğŸŸ¡ Medium â”‚    â”‚  ğŸŸ¢ Low    â”‚                 â”‚  â”‚
â”‚  â”‚  â”‚  Risk      â”‚    â”‚  Risk      â”‚    â”‚  Risk      â”‚                 â”‚  â”‚
â”‚  â”‚  â”‚  (>70%)    â”‚    â”‚  (30-70%)  â”‚    â”‚  (<30%)    â”‚                 â”‚  â”‚
â”‚  â”‚  â”‚            â”‚    â”‚            â”‚    â”‚            â”‚                 â”‚  â”‚
â”‚  â”‚  â”‚  â†’ Alert   â”‚    â”‚  â†’ Watch   â”‚    â”‚  â†’ Normal  â”‚                 â”‚  â”‚
â”‚  â”‚  â”‚  â†’ Outreachâ”‚    â”‚  â†’ Monitor â”‚    â”‚            â”‚                 â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 äºˆæ¸¬å¯¾è±¡ã¨ç‰¹å¾´é‡

| äºˆæ¸¬å¯¾è±¡ | ä¸»è¦ç‰¹å¾´é‡ | ç”¨é€” |
|----------|------------|------|
| è§£ç´„ãƒªã‚¹ã‚¯ | ãƒ­ã‚°ã‚¤ãƒ³é »åº¦ä½ä¸‹ã€åˆ©ç”¨æ©Ÿèƒ½æ¸›å°‘ã€æ”¯æ‰•ã„å¤±æ•—ã€ã‚µãƒãƒ¼ãƒˆå•ã„åˆã‚ã›å¢— | ãƒ—ãƒ­ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªãƒªãƒ†ãƒ³ã‚·ãƒ§ãƒ³æ–½ç­– |
| ã‚¢ãƒƒãƒ—ã‚»ãƒ«å¯èƒ½æ€§ | åˆ©ç”¨é‡å¢—åŠ ã€ä¸Šä½æ©Ÿèƒ½ã®è©¦ç”¨ã€ç«¶åˆæ¤œè¨å…†å€™ | é©åˆ‡ãªã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§ã®ææ¡ˆ |
| ç•°å¸¸æ¤œçŸ¥ | æ€¥æ¿€ãªåˆ©ç”¨ãƒ‘ã‚¿ãƒ¼ãƒ³å¤‰åŒ– | ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã€å“è³ªå•é¡Œã®æ—©æœŸç™ºè¦‹ |

---

## 4ï¸âƒ£ ã‚«ã‚¹ã‚¿ãƒ ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰

### 4.1 ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ãƒ“ãƒ«ãƒ€ãƒ¼

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Custom Dashboard Builder                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Toolbar                                                             â”‚  â”‚
â”‚  â”‚  [+ Add Widget] [ğŸ“Š Chart] [ğŸ“ˆ Metric] [ğŸ“‹ Table] [ğŸ¯ Goal]         â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Widget Library           â”‚  Dashboard Canvas                        â”‚  â”‚
â”‚  â”‚                           â”‚                                          â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚
â”‚  â”‚  â”‚ ğŸ“Š Line Chart       â”‚ â”‚  â”‚  Widget 1   â”‚ â”‚      Widget 2       â”‚ â”‚  â”‚
â”‚  â”‚  â”‚ ğŸ“Š Bar Chart        â”‚ â”‚  â”‚  (2x1)      â”‚ â”‚      (2x2)          â”‚ â”‚  â”‚
â”‚  â”‚  â”‚ ğŸ© Pie Chart        â”‚ â”‚  â”‚             â”‚ â”‚                     â”‚ â”‚  â”‚
â”‚  â”‚  â”‚ ğŸ“ˆ Single Metric    â”‚ â”‚  â”‚   â–² 15%    â”‚ â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚  â”‚
â”‚  â”‚  â”‚ ğŸ“‹ Data Table       â”‚ â”‚  â”‚   MRR      â”‚ â”‚    â”‚ â–„â–„â–„ â–„â–„â–„  â”‚   â”‚ â”‚  â”‚
â”‚  â”‚  â”‚ ğŸ—ºï¸ Geo Map         â”‚ â”‚  â”‚             â”‚ â”‚    â”‚â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â”‚   â”‚ â”‚  â”‚
â”‚  â”‚  â”‚ ğŸ“… Calendar         â”‚ â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚                   â”‚                     â”‚ â”‚  â”‚
â”‚  â”‚                           â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚           Widget 3 (4x1)            â”‚ â”‚  â”‚
â”‚  â”‚  â”‚ Data Sources        â”‚ â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚  â”‚
â”‚  â”‚  â”‚ â—‹ Usage Events      â”‚ â”‚  â”‚  â”‚ Table: Top Users by Usage     â”‚  â”‚ â”‚  â”‚
â”‚  â”‚  â”‚ â—‹ Revenue Data      â”‚ â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚  â”‚
â”‚  â”‚  â”‚ â—‹ Support Tickets   â”‚ â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚  â”‚
â”‚  â”‚  â”‚ â—‹ Custom Query      â”‚ â”‚                                          â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚                                          â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  [Preview] [Save] [Share] [Schedule Export]                         â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.2 ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«

```java
@Entity
@Table(name = "custom_dashboards")
public class CustomDashboard {
    @Id
    @GeneratedValue(strategy = GenerationType.UUID)
    private String id;

    @Column(nullable = false)
    private String tenantId;

    @Column(nullable = false)
    private String createdByUserId;

    @Column(nullable = false)
    private String name;

    private String description;

    @Enumerated(EnumType.STRING)
    private DashboardVisibility visibility; // PRIVATE, TEAM, TENANT

    @Column(columnDefinition = "jsonb", nullable = false)
    private String layout; // ã‚°ãƒªãƒƒãƒ‰ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆæƒ…å ±

    private LocalDateTime createdAt;
    private LocalDateTime updatedAt;
}

@Entity
@Table(name = "dashboard_widgets")
public class DashboardWidget {
    @Id
    @GeneratedValue(strategy = GenerationType.UUID)
    private String id;

    @Column(nullable = false)
    private String dashboardId;

    @Enumerated(EnumType.STRING)
    private WidgetType type; // LINE_CHART, BAR_CHART, METRIC, TABLE, etc.

    @Column(nullable = false)
    private String title;

    @Column(columnDefinition = "jsonb", nullable = false)
    private String config; // ã‚¦ã‚£ã‚¸ã‚§ãƒƒãƒˆè¨­å®š

    @Column(columnDefinition = "jsonb", nullable = false)
    private String query; // ãƒ‡ãƒ¼ã‚¿å–å¾—ã‚¯ã‚¨ãƒª

    // Grid position
    private int gridX;
    private int gridY;
    private int gridWidth;
    private int gridHeight;

    private LocalDateTime createdAt;
    private LocalDateTime updatedAt;
}
```

### 4.3 ã‚¯ã‚¨ãƒªãƒ“ãƒ«ãƒ€ãƒ¼

```typescript
// ã‚¯ã‚¨ãƒªè¨­å®šä¾‹
interface WidgetQuery {
  dataSource: 'usage_events' | 'revenue' | 'support' | 'custom';
  metrics: Array<{
    field: string;
    aggregation: 'count' | 'sum' | 'avg' | 'min' | 'max';
    alias?: string;
  }>;
  dimensions?: Array<{
    field: string;
    alias?: string;
  }>;
  filters?: Array<{
    field: string;
    operator: 'eq' | 'ne' | 'gt' | 'gte' | 'lt' | 'lte' | 'in' | 'like';
    value: any;
  }>;
  timeRange?: {
    type: 'relative' | 'absolute';
    value: string; // 'last_7_days', 'last_30_days', or ISO date range
  };
  groupBy?: string[];
  orderBy?: Array<{
    field: string;
    direction: 'asc' | 'desc';
  }>;
  limit?: number;
}

// ä½¿ç”¨ä¾‹: éå»30æ—¥ã®æ—¥åˆ¥ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãƒ¦ãƒ¼ã‚¶ãƒ¼
const query: WidgetQuery = {
  dataSource: 'usage_events',
  metrics: [
    { field: 'user_id', aggregation: 'count', alias: 'active_users' }
  ],
  dimensions: [
    { field: 'date', alias: 'day' }
  ],
  filters: [
    { field: 'event_type', operator: 'eq', value: 'page_view' }
  ],
  timeRange: { type: 'relative', value: 'last_30_days' },
  groupBy: ['date'],
  orderBy: [{ field: 'date', direction: 'asc' }]
};
```

---

## ğŸ“Š å·¥æ•°è¦‹ç©

| æ©Ÿèƒ½ | ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ | ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ | ML/ãƒ‡ãƒ¼ã‚¿ | åˆè¨ˆ |
|------|----------------|--------------|-----------|------|
| åˆ©ç”¨çŠ¶æ³ã‚¢ãƒŠãƒªãƒ†ã‚£ã‚¯ã‚¹ | 5äººæ—¥ | 8äººæ—¥ | - | 13äººæ—¥ |
| åç›Šåˆ†æãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ | 5äººæ—¥ | 5äººæ—¥ | - | 10äººæ—¥ |
| ã‚³ãƒ›ãƒ¼ãƒˆåˆ†æ | 3äººæ—¥ | 5äººæ—¥ | - | 8äººæ—¥ |
| è§£ç´„äºˆæ¸¬ãƒ¢ãƒ‡ãƒ« | 3äººæ—¥ | 5äººæ—¥ | 15äººæ—¥ | 23äººæ—¥ |
| ã‚«ã‚¹ã‚¿ãƒ ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ | 15äººæ—¥ | 10äººæ—¥ | - | 25äººæ—¥ |
| **åˆè¨ˆ** | **31äººæ—¥** | **33äººæ—¥** | **15äººæ—¥** | **79äººæ—¥** |

---

*æ¬¡: [ã‚¨ãƒ³ã‚¿ãƒ¼ãƒ—ãƒ©ã‚¤ã‚ºæ©Ÿèƒ½](./05_enterprise-features.md)*
